<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Документация</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="Документация для расширений Taptop" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0"
    />
    <link rel="icon" href="./favicon.png" type="image/png" />
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css"
    />

    <!-- Общие стили -->
    <link rel="stylesheet" href="./css/common/base.css" />
    <link rel="stylesheet" href="./css/common/forms.css" />
    <link rel="stylesheet" href="./css/common/modals.css" />
    <link rel="stylesheet" href="./css/common/components.css" />

    <!-- Стили для генераторов -->
    <link rel="stylesheet" href="./css/generators/cookie.css" />
    <link rel="stylesheet" href="./css/generators/smooth-scroll.css" />
    <link rel="stylesheet" href="./css/generators/multilanding.css" />
  </head>
  <body>
    <div id="app"></div>
    <script>
      window.$docsify = {
        name: "f",
        repo: "",
        loadSidebar: true,
        alias: {
          "/.*/_sidebar.md": "/_sidebar.md",
        },
        homepage: "./guide.md",
        subMaxLevel: 2,
        name: "taptop",
        themeColor: "#3290ff",
        auto2top: true,
      };
    </script>
    <!-- Docsify v4 -->
    <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>

    <!-- Утилиты -->
    <script type="module" src="./js/utils/minifyCode.js"></script>
    <script type="module" src="./js/utils/copyToClipboard.js"></script>
    <script type="module" src="./js/utils/modal.js"></script>

    <!-- Базовый класс генератора -->
    <script type="module" src="./js/generators/baseGenerator.js"></script>

    <!-- Генераторы -->
    <script type="module" src="./js/generators/cookieGenerator.js"></script>
    <script
      type="module"
      src="./js/generators/smoothScrollGenerator.js"
    ></script>
    <script
      type="module"
      src="./js/generators/multilandingGenerator.js"
    ></script>

    <!-- Доксифай-плагин для инициализации после рендера -->
    <script>
      if (window.$docsify) {
        window.$docsify.plugins = window.$docsify.plugins || [];
        window.$docsify.plugins.push(function (hook) {
          hook.doneEach(function () {
            setTimeout(function () {
              if (window.initGenerators) {
                window.initGenerators();
              }
            }, 300);
          });
        });
      }
    </script>

    <script type="module">
      import { CookieGenerator } from "./js/generators/cookieGenerator.js";
      import { SmoothScrollGenerator } from "./js/generators/smoothScrollGenerator.js";
      import { DynamicContentGenerator } from "./js/generators/multilandingGenerator.js";
      import generatorsManager from "./js/generators/generatorsManager.js";

      // Функция для запуска после загрузки DOM
      function initializeGenerators() {
        // Регистрируем генераторы
        generatorsManager
          .register("cookie", CookieGenerator, "#cookie-generator")
          .register(
            "smoothScroll",
            SmoothScrollGenerator,
            "#smooth-scroll-generator"
          )
          .register(
            "dynamicContent",
            DynamicContentGenerator,
            ".dcm-container"
          );

        generatorsManager.initAll();
      }

      // Запускаем инициализацию
      document.addEventListener("DOMContentLoaded", initializeGenerators);

      // Переопределяем глобальный метод инициализации для Docsify
      window.initGenerators = function () {
        if (generatorsManager.initialized) {
          generatorsManager.reset();
        }
        generatorsManager.initAll();
      };
    </script>
  </body>
</html>
